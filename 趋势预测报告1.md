# 趋势预测报告

[参考代码链接](*https://github.com/xiao21wei/technology*)

本次趋势预测使用到的数据集是`P2072B`设备上的`cs4`测点的加速度低频数据。这组数据的特点是数据量足够大，数据变化范围较小，数据的变化规律不明显。

**数据参数**

| 参数             | 值                    |
| ---------------- | --------------------- |
| 开始时间         | 2023-04-26 16: 04: 14 |
| 分隔时间         | 2023-05-03 16: 04: 14 |
| 结束时间         | 2023-05-04 16: 04: 14 |
| 训练数据集数据量 | 133436                |
| 测试数据集数据量 | 20254                 |

## 统计学模型

首先，我们构建统计学模型中常用的prophet模型，使用训练数据集对模型进行训练，并在测试训练集上使用该模型进行预测。最后，我们将预测结果绘制到图像中。

![image-20230517140548620](趋势预测报告1.assets/image-20230517140548620.png)

我们使用该模型依次对测试数据集上的一天，12小时，6小时，3小时，1小时，30分钟，15分钟，5分钟进行预测，最终得到了如下的测试结果。

一天：

![image-20230515100513010](趋势预测报告1.assets/image-20230515100513010.png)

12小时：

![image-20230515101322937](趋势预测报告1.assets/image-20230515101322937.png)

6小时：

![image-20230515101501030](趋势预测报告1.assets/image-20230515101501030.png)

3小时：

![image-20230515102055446](趋势预测报告1.assets/image-20230515102055446.png)

1小时：

![image-20230515102138008](趋势预测报告1.assets/image-20230515102138008.png)

30分钟：

![image-20230515102227447](趋势预测报告1.assets/image-20230515102227447.png)

15分钟：

![image-20230515102316913](趋势预测报告1.assets/image-20230515102316913.png)

5分钟：

![image-20230515102358087](趋势预测报告1.assets/image-20230515102358087.png)

分析以上的测试结果可知，此时模型预测得到的趋势近似为一条直线，说明模型的参数设置存在一定的问题，不能直接使用默认的参数。这部分的优化需要后续对该模型的参数进行调优，设置合适的参数。

考虑到这部分的参数调整需要耗费一定的时间和精力，暂时未完成这部分的内容。

## 机器学习模型

我们使用时序预测的模型中常用的机器学习模型——随机森林模型来完成这部分的趋势预测。

对于随机森林模型，我们首先需要通过滑动窗口的方式来提取数据的特征和标签。不同的特征提取窗口长度会在一定程度上影响到数据预测的结果，所以我们先通过测试，选取出较为合适的特征提取窗口长度。我们使用训练数据集的最后一天的数据和测试数据集来对测试数据集的前5分钟的数据，在特征提取窗口在5~30的范围内，进行预测，并将测试结果绘制到图像中。

![image-20230515133954389](趋势预测报告1.assets/image-20230515133954389.png)

![image-20230515134019476](趋势预测报告1.assets/image-20230515134019476.png)

![image-20230515134036101](趋势预测报告1.assets/image-20230515134036101.png)

![image-20230515134052534](趋势预测报告1.assets/image-20230515134052534.png)

![image-20230515134107936](趋势预测报告1.assets/image-20230515134107936.png)

![image-20230515134123749](趋势预测报告1.assets/image-20230515134123749.png)

![image-20230515134137258](趋势预测报告1.assets/image-20230515134137258.png)

![image-20230515134155124](趋势预测报告1.assets/image-20230515134155124.png)

![image-20230515134221572](趋势预测报告1.assets/image-20230515134221572.png)

![image-20230515134237370](趋势预测报告1.assets/image-20230515134237370.png)

![image-20230515134250951](趋势预测报告1.assets/image-20230515134250951.png)

![image-20230515134302878](趋势预测报告1.assets/image-20230515134302878.png)

![image-20230515134319004](趋势预测报告1.assets/image-20230515134319004.png)

![image-20230515134331322](趋势预测报告1.assets/image-20230515134331322.png)

![image-20230515134349859](趋势预测报告1.assets/image-20230515134349859.png)

![image-20230515134402440](趋势预测报告1.assets/image-20230515134402440.png)

![image-20230515134415151](趋势预测报告1.assets/image-20230515134415151.png)

![image-20230515134427800](趋势预测报告1.assets/image-20230515134427800.png)

![image-20230515134441984](趋势预测报告1.assets/image-20230515134441984.png)

![image-20230515134457128](趋势预测报告1.assets/image-20230515134457128.png)

![image-20230515134512242](趋势预测报告1.assets/image-20230515134512242.png)

![image-20230515134529869](趋势预测报告1.assets/image-20230515134529869.png)

![image-20230515134549356](趋势预测报告1.assets/image-20230515134549356.png)

![image-20230515134603406](趋势预测报告1.assets/image-20230515134603406.png)

![image-20230515134613379](趋势预测报告1.assets/image-20230515134613379.png)

![image-20230515134625061](趋势预测报告1.assets/image-20230515134625061.png)

综合比较后，当特征提取窗口长度为10的时候，趋势预测的结果最为接近实际情况。所以，接下来我们将10作为特征提取窗口长度，使用训练数据集中的全部数据来训练模型，并在测试数据集上，依次对一天，12小时，6小时，3小时，1小时，30分钟，15分钟，5分钟进行预测，最终得到了如下的测试结果：

一天

![image-20230515143716616](趋势预测报告1.assets/image-20230515143716616.png)

12小时

![image-20230515144209815](趋势预测报告1.assets/image-20230515144209815.png)

6小时

![image-20230515144437089](趋势预测报告1.assets/image-20230515144437089.png)

3小时

![image-20230515144623986](趋势预测报告1.assets/image-20230515144623986.png)

1小时

![image-20230515144842256](趋势预测报告1.assets/image-20230515144842256.png)

30分钟

![image-20230515145253853](趋势预测报告1.assets/image-20230515145253853.png)

15分钟

![image-20230515145457263](趋势预测报告1.assets/image-20230515145457263.png)

5分钟

![image-20230515145721198](趋势预测报告1.assets/image-20230515145721198.png)

预测结果显示，在趋势预测的前半部分，该模型能够给出较为合理的预测结果，虽然预测数据和实际情况存在一定的差异，但是这个差距在能够接受的范围内，但是当数据预测进行到后半部分时，数据的预测结果开始出现较大的偏差，这是由于预测数据的前半部分存在偏差的数据作为了模型预测的输入，进一步增大了预测数据和真实数据的差异，导致预测的结果较差。

## 循环神经网络

我们使用时序预测中常用的循环神经网络模型——LSTM模型，来完成这部分的时序预测。

对于LSTM模型，我们需要考虑不同是时间步个数对预测结果的影响。时间步是指数据依次进入模型时，模型中的用于下一步预测的数据的数量，在正式进行测试之前，我们需要对该模型的最优时间步个数进行测试。我们使用训练数据集的最后一天的数据对该模型进行训练，并在测试数据集的前5分钟上的数据进行测试，测试过程中得到的图像如下：

![image-20230517100421172](趋势预测报告1.assets/image-20230517100421172.png)

![image-20230517100433908](趋势预测报告1.assets/image-20230517100433908.png)

![image-20230517100651269](趋势预测报告1.assets/image-20230517100651269.png)

![image-20230517100705666](趋势预测报告1.assets/image-20230517100705666.png)

![image-20230517100720370](趋势预测报告1.assets/image-20230517100720370.png)

![image-20230517100812164](趋势预测报告1.assets/image-20230517100812164.png)

![image-20230517100837171](趋势预测报告1.assets/image-20230517100837171.png)

![image-20230517100850343](趋势预测报告1.assets/image-20230517100850343.png)

![image-20230517100905673](趋势预测报告1.assets/image-20230517100905673.png)

![image-20230517100923833](趋势预测报告1.assets/image-20230517100923833.png)

![image-20230517100938402](趋势预测报告1.assets/image-20230517100938402.png)

![image-20230517101013930](趋势预测报告1.assets/image-20230517101013930.png)

![image-20230517101044532](趋势预测报告1.assets/image-20230517101044532.png)

![image-20230517101055298](趋势预测报告1.assets/image-20230517101055298.png)

![image-20230517101106303](趋势预测报告1.assets/image-20230517101106303.png)

![image-20230517101118698](趋势预测报告1.assets/image-20230517101118698.png)

![image-20230517101129951](趋势预测报告1.assets/image-20230517101129951.png)

![image-20230517101140413](趋势预测报告1.assets/image-20230517101140413.png)

![image-20230517101202114](趋势预测报告1.assets/image-20230517101202114.png)

![image-20230517101215164](趋势预测报告1.assets/image-20230517101215164.png)

![image-20230517101226477](趋势预测报告1.assets/image-20230517101226477.png)

![image-20230517101239175](趋势预测报告1.assets/image-20230517101239175.png)

![image-20230517101250075](趋势预测报告1.assets/image-20230517101250075.png)

![image-20230517101301848](趋势预测报告1.assets/image-20230517101301848.png)

![image-20230517101317250](趋势预测报告1.assets/image-20230517101317250.png)

![image-20230517101330978](趋势预测报告1.assets/image-20230517101330978.png)

测试结果显示，当时间步个数的值为14时，测试结果表现较好。

我们将时间步个数设置为14，使用训练数据集中的全部数据来训练模型，并在测试数据集上，依次对一天，12小时，6小时，3小时，1小时，30分钟，15分钟，5分钟进行预测，最终得到了如下的测试结果：

一天

![image-20230517104904125](趋势预测报告1.assets/image-20230517104904125.png)

12小时

![image-20230517105145950](趋势预测报告1.assets/image-20230517105145950.png)

6小时

![image-20230517105356706](趋势预测报告1.assets/image-20230517105356706.png)

3小时

![image-20230517105527791](趋势预测报告1.assets/image-20230517105527791.png)

1小时

![image-20230517105744467](趋势预测报告1.assets/image-20230517105744467.png)

30分钟

![image-20230517110308213](趋势预测报告1.assets/image-20230517110308213.png)

15分钟

![image-20230517110434577](趋势预测报告1.assets/image-20230517110434577.png)

5分钟

![image-20230517100923833](趋势预测报告1.assets/image-20230517100923833.png)

最终的预测结果显示，该模型的趋势预测还有可以提升的地方，在后续的优化过程中，应当，重点关注该模型的参数调优，为该模型设置较为合适的参数，以达到更好的预测效果。

## 总结

随着训练数据集的数据量增大，得到的趋势预测曲线，开始能够与更多的真实情况形成对应。可见，数据量的提升可以在一定程度上提升模型的趋势预测性能。但是，对于部分模型来说，过大的数据量会导致模型出现过拟合现象，导致模型会忽略部分的较大值和较小值，最终很有可能会得到一条反应大部分数据集中情况的近似为直线的趋势预测曲线，这种情况只能通过参数调优来解决，但是参数调优是一个非常耗费时间和精力的过程，需要我们在现有测试的数据基础上，比较不同参数对模型的趋势预测结果的影响，最终得到对数据趋势预测表现最好的一组参数，使用这组参数来进行最终的趋势预测，得到预测数据。